"use strict";var academicYear="\u0627\u0644\u0635\u0641 \u0627\u0644\u062B\u0627\u0644\u062B \u0627\u0644\u062A\u062C\u0627\u0631\u0649";var getDataBases;var sections;var questions;var questionsId=[];var counter=0;var getQuestion;var varGetDataBase;var curentSection;var wrongAnswer=0;var trueAnswer=0;function funUniqId(){return Math.random().toString(36).substr(2,9)};if(localStorage.getItem("UniqId")==null){localStorage.setItem("UniqId",funUniqId())}var UniqId=localStorage.getItem("UniqId");var xNavigator=navigator.userAgent.replace(/[ \;\/\(\-\.\,\)]/g,"");function checkAllAnswer(x){var y=AF(x).includes("\u062C\u0645\u064A\u0639")&&AF(x).includes("\u0633\u0628\u0642");return y}function AF(x){return x.replace(/[\ّ\َ\ً\ُ\ٌ\ِ\ٍ\ْ]/g,"")}function funRandom(x){return x.sort(function(){return Math.random()-0.5})}function AB(x){if(x.some(checkAllAnswer)){return x}else{var y=funRandom(x);return y}}firebase.database().ref("student/"+academicYear).once("value").then(function(x){getDataBases=x.val();StartHomePage();$("#wait-page").remove()});function StartHomePage(){if(localStorage.getItem(academicYear)==null){localStorage.setItem(academicYear,0)}else{localStorage.setItem(academicYear,Number(localStorage.getItem(academicYear))+1)}var xDate=Date.now();var ObjectXDate={};ObjectXDate[xDate]=localStorage.getItem(academicYear);database.ref("analysis/"+academicYear+"/"+xNavigator+"/"+UniqId+"/start").update(ObjectXDate);console.log(ObjectXDate);$("#question").hide();$("#home-page").show();$("#home-page .enter").html("");for(var getDataBase in getDataBases){$("#home-page .enter").append("<button onclick=\"funSectionPage('"+getDataBase+"')\" class=\"btn btn-primary btn-block\">"+AF(getDataBase)+"</button>")}}function funSectionPage(x){sections=getDataBases[x];varGetDataBase=x;$("#home-page .enter").html("");console.log(sections);for(var section in sections){$("#home-page .enter").append("<button onclick=\"funQuestion('"+section+"')\" class=\"btn btn-primary btn-block\">"+AF(section)+"</button>")}$("#home-page .enter").append("<button onclick=\"StartHomePage()\" class=\"btn-go-back bg-danger\"> <i class=\"icofont-sign-out\"></i> </button>")}function funQuestion(x){wrongAnswer=0;trueAnswer=0;questions=sections[x];for(var question in questions){questionsId.push(question)}curentSection=x;if(localStorage.getItem(curentSection)==null){localStorage.setItem(curentSection,0)}else if(Number(localStorage.getItem(curentSection))>=3){questionsId=funRandom(questionsId)}$("#question").show();$("#home-page").hide();funinsertQuestion()}function funinsertQuestion(){$("#answer-and-note").hide();$("#transparency").hide();$("#question .enter").html("");getQuestion=questions[questionsId[counter]];getAnswerLength=getQuestion.answers.length;if(getAnswerLength==1){$("#question .enter").append("<h3>"+AF(getQuestion.question.replace(/\#/g,"<div class=\"form-group\"><input autocomplete=\"off\" id=\"input-answer\" type=\"text\" class=\"form-control\"></div>"))+"</h3>");$("#question .enter").append("<button class='btn btn-primary btn-block' onclick='funAnswer2(\""+getQuestion.answers[0]+"\")'>OK</button>")}else{$("#question .enter").append("<h3>"+AF(getQuestion.question.replace(/\#/g,".........."))+"</h3>");for(var a in AB(getQuestion.answers)){$("#question .enter").append("<button class='btn btn-primary btn-block' onclick='funAnswer(this)'>"+AF(getQuestion.answers[a])+"</button>")}}$(".progress .progress-bar").css("width",counter/questionsId.length*100+"%")}function funAnswer2(x){$("#answer-and-note").show();$("#transparency").show();var inputAnswer=$("#input-answer").val().replace(/[ ًٌٍَُِّْ]/g,"").replace(/[أإآ]/g,"\u0627").replace(/[ة]/g,"\u0647").replace(/[ي]/g,"\u064A").replace(/ال/g,"");var inputAnswerArray=inputAnswer.split("");var realAnswer=x.replace(/[ ًٌٍَُِّْ]/g,"").replace(/[أإآ]/g,"\u0627").replace(/[ة]/g,"\u0647").replace(/[ي]/g,"\u064A").replace(/ال/g,"");var realAnswerArray=realAnswer.split("");var validate=0;for(var a in inputAnswerArray){for(var b in realAnswerArray){if(a==b){validate++}}}if(realAnswerArray.length>3){console.log(validate);console.log(realAnswerArray.length/1.5+"  : "+realAnswerArray.length);console.log("a");if(validate==realAnswerArray.length/1.5){trueAnswer++;$("#answer-and-note #p1").html("\u0627\u062D\u0633\u0646\u062A \u0627\u0644\u0627\u062C\u0627\u0628\u0647 \u0647\u0649 :");$("#answer-and-note #p2").html(AF(getQuestion.answer+" "+getQuestion.note));$("#answer-and-note").removeClass("bg-success");$("#answer-and-note").removeClass("bg-danger");$("#answer-and-note").addClass("bg-success");document.getElementById("right_answer").play()}else if(validate>realAnswerArray.length/1.5){trueAnswer++;$("#answer-and-note #p1").html("\u0627\u0643\u064A\u062F \u0643\u0646\u062A \u062A\u0631\u064A\u062F \u0627\u0646 \u062A\u0643\u062A\u0628 :");$("#answer-and-note #p2").html(AF(getQuestion.answer+" "+getQuestion.note));$("#answer-and-note").removeClass("bg-success");$("#answer-and-note").removeClass("bg-danger");$("#answer-and-note").addClass("bg-success");document.getElementById("right_answer").play()}else{wrongAnswer++;$("#answer-and-note #p1").html("\u062D\u0627\u0648\u0644 \u0645\u0631\u0647 \u0623\u062E\u0631\u0649 \u0627\u0644\u0627\u062C\u0627\u0628\u0629 \u0647\u064A");$("#answer-and-note #p2").html(AF(getQuestion.answer+" "+getQuestion.note));questionsId.push(questionsId[counter]);$("#answer-and-note").removeClass("bg-success");$("#answer-and-note").removeClass("bg-danger");$("#answer-and-note").addClass("bg-danger");document.getElementById("wrong_answer").play()}}else{console.log(validate);console.log("b");if(validate==realAnswerArray.length){console.log(validate);console.log(realAnswerArray.length+"  : "+realAnswerArray.length);trueAnswer++;$("#answer-and-note #p1").html("\u0627\u062D\u0633\u0646\u062A \u0627\u0644\u0627\u062C\u0627\u0628\u0647 \u0647\u0649 :");$("#answer-and-note #p2").html(AF(getQuestion.answer+" "+getQuestion.note));$("#answer-and-note").removeClass("bg-success");$("#answer-and-note").removeClass("bg-danger");$("#answer-and-note").addClass("bg-success");document.getElementById("right_answer").play()}else{wrongAnswer++;$("#answer-and-note #p1").html("\u062D\u0627\u0648\u0644 \u0645\u0631\u0647 \u0623\u062E\u0631\u0649 \u0627\u0644\u0627\u062C\u0627\u0628\u0629 \u0647\u064A");$("#answer-and-note #p2").html(AF(getQuestion.answer+" "+getQuestion.note));questionsId.push(questionsId[counter]);$("#answer-and-note").removeClass("bg-success");$("#answer-and-note").removeClass("bg-danger");$("#answer-and-note").addClass("bg-danger");document.getElementById("wrong_answer").play()}}}function funAnswer(x){$("#answer-and-note").show();$("#transparency").show();if($(x).text()==AF(getQuestion.answer)){trueAnswer++;$("#answer-and-note #p1").html("\u0627\u062D\u0633\u0646\u062A \u0627\u0644\u0627\u062C\u0627\u0628\u0647 \u0647\u0649 :");$("#answer-and-note #p2").html(AF(getQuestion.answer+" "+getQuestion.note));$("#answer-and-note").removeClass("bg-success");$("#answer-and-note").removeClass("bg-danger");$("#answer-and-note").addClass("bg-success");document.getElementById("right_answer").play()}else{wrongAnswer++;$("#answer-and-note #p1").html("\u062D\u0627\u0648\u0644 \u0645\u0631\u0647 \u0623\u062E\u0631\u0649 \u0627\u0644\u0627\u062C\u0627\u0628\u0629 \u0647\u064A");$("#answer-and-note #p2").html(AF(getQuestion.answer+" "+getQuestion.note));questionsId.push(questionsId[counter]);$("#answer-and-note").removeClass("bg-success");$("#answer-and-note").removeClass("bg-danger");$("#answer-and-note").addClass("bg-danger");document.getElementById("wrong_answer").play()}}function funNext(){if(counter==questionsId.length-1){success()}else{counter++}funinsertQuestion()}function funExit(){$("#success").hide();$("#question").hide();$("#home-page").show();questionsId=[];counter=0;funSectionPage(varGetDataBase)}$(window).bind("beforeunload",function(){return"\u0647\u0644 \u0627\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u0623\u0646\u0643 \u062A\u0631\u064A\u062F \u0627\u0644\u062E\u0631\u0648\u062C \u061F"});function success(){$("#success").show();localStorage.setItem(curentSection,Number(localStorage.getItem(curentSection))+1);var xDate=Date.now();var ObjectXDate={};var xCount=localStorage.getItem(curentSection);ObjectXDate["d"+xDate]={count:xCount,wrong:wrongAnswer,"true":trueAnswer,all:questionsId.length};console.log(ObjectXDate);database.ref("analysis/"+academicYear+"/"+xNavigator+"/"+UniqId+"/success/"+curentSection).update(ObjectXDate)}